
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Query Foundation Models with Databricks SQL &#8212; Databricks Generative AI Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-6BZ4NTBHVJ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-6BZ4NTBHVJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-6BZ4NTBHVJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nbs/ai_sql_functions';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fast Classification with Provisioned Throughput" href="fast_classification_provisioned.html" />
    <link rel="prev" title="Databricks Mosaic AI Generative AI Cookbook" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo2.png" class="logo__image only-light" alt="Databricks Generative AI Cookbook - Home"/>
    <script>document.write(`<img src="../_static/logo2.png" class="logo__image only-dark" alt="Databricks Generative AI Cookbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">All Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Query Foundation Models with Databricks SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="fast_classification_provisioned.html">Fast Classification with Provisioned Throughput</a></li>
<li class="toctree-l1"><a class="reference internal" href="fm_api_mlflow_prompt_eng.html">Using the MLflow Prompt Engineering UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="fm_api_openai_sdk.html">Querying the Foundation Model API with the OpenAI Python SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="fm_api_outside_db.html">Using the Foundation Model API Outside of Databricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_generation_parameters.html">Adjusting Foundation Model Behavior with Generation Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="manage_chat_sessions.html">Managing Chat Sessions in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="playground.html">Test models with the Databricks AI Playground</a></li>
<li class="toctree-l1"><a class="reference internal" href="serve_marketplace.html">Serve a Model from Databricks Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="streaming_outputs.html">Streaming Outputs with the Foundation Model API</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_search_fm_api.html">Foundation Model API Embeddings for Vector Search</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/databricks-genai-cookbook/cookbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/databricks-genai-cookbook/cookbook/issues/new?title=Issue%20on%20page%20%2Fnbs/ai_sql_functions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/nbs/ai_sql_functions.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Query Foundation Models with Databricks SQL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-syntax">Basic Syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-completions">Generate Completions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-embeddings">Generate Embeddings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-ai-sql-functions-to-multiple-rows">Applying AI SQL Functions to multiple rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="query-foundation-models-with-databricks-sql">
<h1>Query Foundation Models with Databricks SQL<a class="headerlink" href="#query-foundation-models-with-databricks-sql" title="Link to this heading">#</a></h1>
<p>This notebook shows how to use the <a class="reference external" href="https://docs.databricks.com/en/sql/language-manual/functions/ai_query.html"><code class="docutils literal notranslate"><span class="pre">ai_query</span></code></a> SQL function to query models from the Foundation Model API. The <code class="docutils literal notranslate"><span class="pre">ai_query</span></code> function provides a simple and familiar SQL interface to Large Language Models via the Foundation Model API. It also provides a straightforward way to integrate LLMs into existing SQL-based Databricks workflows.</p>
<section id="basic-syntax">
<h2>Basic Syntax<a class="headerlink" href="#basic-syntax" title="Link to this heading">#</a></h2>
<p>The most basic usage of the <code class="docutils literal notranslate"><span class="pre">ai_query</span></code> function takes a model endpoint name and a text query and returns a single result.</p>
<section id="generate-completions">
<h3>Generate Completions<a class="headerlink" href="#generate-completions" title="Link to this heading">#</a></h3>
<p>We can generate chat or text completions with supported Foundation Model API models as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sql</span>
<span class="n">SELECT</span> <span class="n">ai_query</span><span class="p">(</span><span class="s2">&quot;databricks-llama-2-70b-chat&quot;</span><span class="p">,</span> <span class="s2">&quot;What is model logging in MLflow?&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style scoped>
  .table-result-container {
    max-height: 300px;
    overflow: auto;
  }
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 5px;
  }
  th {
    text-align: left;
  }
</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>ai_query(databricks-llama-2-70b-chat, What is model logging in MLflow?, returnTypeDefaultValue)</th></tr></thead><tbody><tr><td>
In MLflow, model logging is the process of tracking and recording events and metrics related to the performance and behavior of machine learning models during their deployment. It is an essential feature of the MLflow platform that enables data scientists and engineers to monitor, analyze, and optimize the performance of their models in production environments.

Model logging in MLflow involves collecting data on various aspects of model behavior, such as:

1. Model predictions: MLflow logs the predictions made by the model for each input it receives, along with the corresponding output.
2. Model performance: MLflow tracks metrics such as accuracy, precision, recall, F1 score, and other custom metrics that are relevant to the specific model and task.
3. Data distribution: MLflow logs information about the distribution of the data that the model processes, including histograms, min/max values, and other summary statistics.
4. Model internals: MLflow can log information about the internal workings of the model, such as the activation values of layers, the gradients, and other parameters that can help in understanding the model's behavior.
5. Environmental variables: MLflow logs information about the environment in which the model is running, including the hardware, software, and other relevant details.

The logged data is stored in a database, and users can query and visualize it using MLflow's built-in tools or third-party visualization platforms. Model logging in MLflow provides several benefits, including:

1. Model performance optimization: By analyzing the logged data, users can identify areas where the model can be improved, such as biases, errors, or inefficiencies.
2. Explainability and interpretability: Logging model behavior helps users understand how the model works, how it makes predictions, and what factors it considers most important.
3. Compliance and auditing: Model logging is essential for ensuring compliance with data privacy and security regulations, as it provides a record of all data processed by the model.
4. Collaboration and knowledge sharing: Logged data can be shared across teams, allowing data scientists and engineers to collaborate more effectively and build upon each other's work.

In summary, model logging in MLflow is a powerful feature that enables users to monitor, analyze, and optimize the performance of their machine learning models in production environments. It provides valuable insights into model behavior, helps improve model performance, and ensures compliance with data privacy and security regulations.</td></tr></tbody></table></div></div></div>
</div>
</section>
<section id="generate-embeddings">
<h3>Generate Embeddings<a class="headerlink" href="#generate-embeddings" title="Link to this heading">#</a></h3>
<p>Similarly, we can generate embeddings with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sql</span>
<span class="n">SELECT</span> <span class="n">ai_query</span><span class="p">(</span><span class="s2">&quot;databricks-bge-large-en&quot;</span><span class="p">,</span> <span class="s2">&quot;What is model logging in MLflow?&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style scoped>
  .table-result-container {
    max-height: 300px;
    overflow: auto;
  }
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 5px;
  }
  th {
    text-align: left;
  }
</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>ai_query(databricks-bge-large-en, What is model logging in MLflow?, returnTypeDefaultValue)</th></tr></thead><tbody><tr><td>List(0.015533447, 0.010643005, -0.023101807, 0.003955841, 0.015945435, -0.008522034, 0.008705139, -0.016174316, 0.01689148, 0.07293701, 0.011688232, -0.002708435, 0.01134491, -0.038848877, -0.03729248, 0.024841309, 0.005264282, -0.0552063, -0.030548096, -0.01939392, 0.02368164, -0.009109497, -0.027511597, -0.0287323, -0.028457642, 0.028030396, 0.0052375793, -0.041992188, 0.07183838, 0.03515625, -0.019210815, 0.028701782, -0.028656006, -0.035491943, -0.0076789856, -0.052093506, 0.0068855286, -0.02078247, -0.032684326, -0.05606079, 0.04458618, 0.0051231384, 0.062683105, -0.07006836, -0.016723633, -0.0096588135, 0.03274536, 0.035369873, 0.05819702, -0.018249512, -0.037628174, 0.001039505, -0.016433716, -0.02645874, -0.027130127, -0.009841919, 0.0029411316, 0.0126953125, -0.04421997, 0.009216309, 0.05053711, 0.03024292, 0.0039634705, -0.07965088, 0.03475952, 0.0077400208, -0.034454346, -0.0018749237, -0.0054092407, -0.01966858, -0.031280518, 0.015731812, -0.01499939, -0.0021762848, -0.038391113, 0.039398193, 0.029510498, -0.008079529, -7.343292E-5, 0.03164673, 0.008239746, 0.021133423, 0.011207581, -0.007129669, -0.0076942444, -0.048431396, 0.008850098, -0.0013341904, -0.033599854, -0.024429321, 0.008117676, 0.06713867, 0.005508423, 0.016174316, 0.023910522, 0.03488159, -0.039245605, 0.028518677, -0.028259277, -0.014930725, 0.025894165, 0.091308594, 0.0178833, 0.0036945343, -0.052947998, -0.016433716, 0.040405273, 0.007171631, -0.0657959, -0.05441284, -0.018997192, 0.027297974, -0.042114258, 0.016723633, -0.044433594, 0.007865906, 0.022369385, -0.012069702, -0.045715332, -0.03286743, 0.03552246, 0.007858276, 0.022918701, -0.05697632, -0.018371582, 0.004917145, -0.0030345917, 0.070617676, -0.0259552, 0.017532349, -0.014915466, -0.043548584, 0.027282715, 0.023895264, -0.0151901245, -0.02067566, -0.009025574, 0.029724121, 0.02255249, 0.012702942, 0.014640808, 0.0027122498, -0.0012168884, 0.07788086, 0.019760132, 0.02911377, 0.029663086, -0.017608643, -0.014350891, -0.0032291412, -0.019973755, -0.0141067505, -0.004081726, 0.044769287, -0.028457642, -0.002281189, -0.06072998, -0.0025081635, 0.0057792664, -0.0015172958, 0.016052246, 0.02255249, -0.060424805, 0.035888672, -0.027893066, 0.029525757, -0.027816772, -0.010948181, 8.1825256E-4, -0.03326416, 0.019042969, -0.009544373, -0.0030918121, 0.007575989, 0.026489258, -1.1074543E-4, -0.017669678, 0.03555298, 0.039794922, 0.0024280548, -0.0024032593, -0.023239136, 0.022399902, 0.0054893494, 0.023788452, 0.0104904175, 0.038848877, 0.013130188, -0.024230957, 0.017364502, -0.005142212, 0.07525635, -0.051513672, 0.042999268, -0.035125732, -0.019958496, -0.067993164, 0.006866455, 0.0015010834, -0.017730713, -0.0129470825, 0.038513184, -0.051696777, -2.477169E-4, -0.06524658, 0.020492554, 0.026733398, 0.043701172, -0.016235352, 0.030883789, 0.03543091, -0.013473511, -0.023727417, -0.07299805, 0.010658264, -0.020248413, 0.0129776, 7.02858E-4, -0.0015134811, -0.02029419, 0.021591187, -0.013931274, 0.031402588, 0.020019531, -0.0014801025, -0.080566406, -0.0029716492, 0.031707764, -0.006111145, -0.002696991, 0.019088745, 0.010269165, 0.03543091, 0.055114746, 0.037200928, 0.008621216, 0.07244873, 0.023925781, 0.010787964, 0.0065460205, 0.0067214966, 0.006401062, -0.006790161, 0.033172607, 0.023849487, -0.025665283, -0.022262573, 0.00667572, -0.003107071, -0.014022827, -0.03567505, 0.043792725, 0.048065186, -0.029556274, -0.01335144, 0.021850586, 0.011764526, 0.047332764, -0.022216797, 0.010093689, 0.009811401, 0.033813477, -0.018249512, -0.0703125, 0.015823364, 0.06573486, 0.008163452, -0.012290955, -9.608269E-4, -0.04119873, 0.008323669, -0.030136108, -0.08654785, -0.02848816, -0.013298035, 0.0036945343, -0.026229858, -0.047424316, -0.025894165, -0.0023708344, 0.008468628, -0.018585205, -0.013648987, 0.03387451, 0.0069732666, 0.001876831, -0.054382324, 0.029388428, -0.05404663, 0.024261475, -0.030639648, -0.029922485, -0.009498596, -0.02607727, 2.2256374E-4, 0.018615723, -0.003255844, -0.048034668, -0.041046143, -0.0052604675, -0.018341064, -0.009117126, 0.012840271, -0.018112183, -0.050689697, 0.027694702, 0.03366089, -0.04458618, 0.017333984, 0.06451416, -0.03375244, 0.020690918, -0.018554688, 0.002243042, -0.03152466, 0.024139404, 0.056640625, -0.020019531, 0.017868042, -0.055908203, -0.011405945, 0.019088745, 5.5265427E-4, -0.021987915, -0.017166138, 0.057525635, 0.033050537, -0.031707764, 0.01828003, 0.0026435852, 0.009994507, -0.03527832, 0.022857666, 0.008728027, 0.068115234, 0.0491333, -0.051239014, -0.06213379, -0.03050232, 0.03149414, 0.0211792, 0.022079468, 0.01537323, 0.032592773, -0.014228821, -0.0042533875, 0.03503418, -0.028213501, 0.0032291412, 0.007575989, -0.006313324, -0.0047035217, 0.003080368, 0.04446411, -0.011917114, 0.023544312, 0.02168274, -0.0041122437, 0.00793457, -0.006134033, 0.014190674, 0.010574341, -0.0014619827, 0.0079574585, -0.035461426, -0.03717041, -0.0104599, 0.0033397675, 0.0440979, -0.0597229, 0.020614624, -3.042221E-4, -0.046325684, -0.006061554, -0.019332886, -0.039367676, 0.007293701, 0.0128479, 0.048034668, -0.03881836, -0.026412964, 0.052337646, 0.0017824173, 0.034240723, 0.04928589, -0.001241684, -0.054260254, -0.023498535, -0.013069153, 0.016311646, -0.024337769, 0.025054932, -0.025146484, -0.0056610107, -0.022583008, -0.04397583, 0.040618896, 0.072753906, 0.0052490234, 0.0042877197, 0.07336426, -0.0031795502, 0.0013828278, 0.026779175, -0.005344391, 0.01751709, -0.022003174, 0.039855957, -0.00466156, 0.02281189, 0.006111145, -0.025970459, 0.006755829, 0.019073486, 0.02571106, -0.023086548, -0.015808105, 0.042022705, 0.023330688, 0.019241333, -0.027893066, -0.0059165955, -0.023773193, 0.011657715, 0.031402588, -0.04647827, 0.04006958, -0.00623703, 0.022476196, 0.012390137, -0.015945435, -0.05999756, -0.022216797, -0.012077332, -0.04714966, 0.067871094, -0.004634857, -0.029663086, -0.030380249, 0.005329132, 0.009880066, 0.0020484924, -0.029525757, -0.014030457, 0.004550934, -0.013908386, 0.043884277, -0.009468079, -0.017562866, -0.046844482, 0.029754639, -0.038208008, 0.0017518997, -0.06756592, 0.03137207, -0.0073547363, -6.0129166E-4, -0.016738892, -0.005897522, 0.018218994, -0.027267456, 0.010322571, 0.012420654, -0.024734497, -0.042297363, 0.050720215, 0.061157227, -0.017364502, 0.041503906, 0.029281616, -0.009399414, 0.013053894, -0.010414124, -0.02420044, -0.005405426, -0.003080368, -0.0028190613, -0.0063285828, -0.004146576, 0.01360321, -0.05291748, 0.033966064, 0.010620117, -0.0013084412, 0.021011353, -0.040618896, -0.03866577, -0.016418457, 0.0095825195, 0.005756378, 0.028839111, 0.011985779, 0.014083862, -0.027008057, -0.0049095154, -0.029251099, -0.046569824, -0.009925842, 0.031555176, 0.03857422, 0.038879395, -0.031066895, -0.0335083, 0.056915283, -0.013389587, -0.017196655, -0.003358841, 0.036743164, 0.03967285, 0.03338623, -0.012237549, -0.029647827, 0.0070610046, -0.053527832, -7.638931E-4, -0.0209198, 0.021499634, -0.0062294006, 0.008079529, -0.014259338, 8.840561E-4, -0.037994385, -0.01890564, -0.012687683, -0.0029411316, -0.003206253, 0.0067634583, -0.037872314, -0.020339966, 0.008644104, 0.01739502, 0.0010557175, -0.0018062592, -0.029510498, -0.06738281, -0.009933472, -0.011917114, 0.047424316, -0.04953003, 2.5689602E-5, 0.03237915, 0.035705566, -0.03277588, -0.010444641, -0.046325684, 0.039215088, -0.003753662, 0.045715332, 0.00982666, -0.024002075, -0.032470703, -0.013748169, 0.028656006, 0.02017212, -0.042877197, -0.0287323, -0.03262329, -0.0047836304, -0.008705139, 0.016082764, 0.011238098, 0.020767212, -0.01424408, -5.7399273E-5, -0.04638672, -0.039154053, 0.0012655258, -0.02659607, 0.066833496, -0.05319214, 0.022949219, -0.0049057007, 0.009613037, -0.023025513, 0.0012283325, -0.030334473, 0.004722595, -0.04953003, -0.06317139, 0.052001953, -0.029800415, -0.013175964, -0.016403198, -0.0060539246, 0.049804688, 0.009597778, 0.0045204163, 0.053527832, 0.016616821, -0.012237549, -0.049865723, 0.020553589, -0.0184021, -0.0019893646, 0.007698059, -3.7789345E-4, -0.052856445, -0.023330688, 0.013290405, -0.035125732, 0.009384155, 0.016540527, 0.016937256, 0.0134887695, 0.03338623, 0.005218506, -0.04537964, -0.03225708, 0.02734375, 0.031982422, 0.05697632, 0.03982544, 0.025421143, 0.029754639, 0.026016235, -0.004295349, -0.029037476, -0.040893555, 0.049194336, 0.002450943, -0.019058228, -0.023605347, 0.018508911, -0.03756714, -0.053649902, 0.006538391, 0.0016727448, 0.0075683594, -0.02130127, -0.02079773, -0.029891968, -0.008972168, 0.006717682, 0.003332138, 0.0023059845, 0.024612427, -0.008743286, -0.008583069, -0.054504395, 0.008621216, 0.04345703, -0.04284668, 0.030410767, -0.026901245, -0.035369873, -0.012825012, 0.01626587, 0.019485474, -0.010429382, 0.021072388, 0.05203247, -0.017578125, 0.05923462, 0.013710022, 0.037872314, 0.031021118, -0.015899658, -0.047210693, -0.021347046, 8.711815E-4, 0.025619507, 0.03503418, 0.0069847107, 0.02758789, 0.045288086, 0.0446167, 0.0031833649, -0.058624268, -0.001042366, -0.049835205, -0.041809082, -0.03829956, -0.011123657, -0.0027675629, -0.0154953, -0.001531601, -0.039154053, -0.020339966, 0.01083374, -0.024627686, -0.0027694702, -0.032989502, 0.0074157715, -0.03817749, 0.008728027, -0.040924072, 0.016036987, 0.030685425, 0.018814087, -0.027435303, 0.024749756, -0.008552551, 0.03665161, -0.024642944, -0.028182983, 0.0066871643, 0.0073432922, 0.003068924, 0.0096588135, -0.06365967, 0.039093018, 0.004047394, -0.011955261, 0.02798462, 0.003944397, -0.013893127, -0.044036865, -8.111E-4, 0.007575989, 3.077984E-4, -0.01727295, -0.022399902, 0.043823242, -0.020614624, -0.010314941, -0.013298035, -0.03302002, 0.018432617, 0.024642944, 0.01058197, 0.030029297, 0.045135498, 0.026779175, -0.034362793, 0.03805542, 0.0056381226, 0.019622803, 0.07446289, 0.008087158, -0.006324768, -0.06262207, 0.04019165, 0.009613037, -0.044006348, 0.029388428, -0.00806427, -0.02128601, -0.012138367, -0.046783447, 0.016555786, 0.07336426, 0.020599365, -0.029785156, -0.025741577, -0.0075263977, -0.029922485, -0.042053223, -0.07965088, 0.02243042, 0.024627686, -0.023330688, 0.00920105, -0.0118255615, 0.012237549, 0.0068740845, 0.045928955, 0.026504517, 0.018356323, 0.00579834, 0.0016012192, 0.0056533813, -0.01625061, 5.7029724E-4, 0.016555786, -0.007171631, 0.00207901, -0.042266846, 0.017181396, 0.061431885, 0.016082764, 0.008598328, 0.0053634644, -0.025726318, -0.008117676, 0.031204224, -0.034698486, -0.010726929, -0.01838684, 0.04083252, 0.018112183, 0.015106201, -0.036102295, -0.02482605, 0.025497437, 1.18136406E-4, 0.021850586, -0.008666992, 0.009338379, -8.8500977E-4, 0.041107178, 0.014480591, 0.015220642, -0.015853882, 0.010871887, -0.010559082, 0.026168823, 0.033569336, 0.03164673, -0.026550293, 0.052703857, 0.024093628, -0.058776855, -0.017120361, 0.0803833, 0.029891968, 0.023376465, -0.010368347, -0.044311523, 0.031982422, -3.4308434E-4, -0.0018835068, -0.014328003, -0.002029419, -0.03390503, -0.011955261, 0.018432617, 0.011833191, 0.012931824, -0.050750732, -0.018875122, -0.01235199, 0.074035645, 0.0012493134, 0.0035686493, 0.023071289, 0.034484863, 0.022903442, 0.034698486, 0.0039863586, 0.039001465, 0.03314209, -0.012916565, 0.022537231, -0.006816864, -3.8146973E-4, -0.036315918, -0.01071167, -0.019699097, -0.010093689, -0.031799316, -0.045959473, 3.2114983E-4, -0.0066604614, -0.0011262894, -0.09106445, -0.0017852783, -0.03274536, -0.0015258789, 0.05328369, -0.003929138, 0.015411377, 0.05142212, 0.05255127, 0.04385376, 0.013244629, 0.073791504, 0.003232956, -0.009376526, 0.031707764, -0.014312744, 0.013000488, 0.009963989, -0.017807007, -0.016845703, 0.039794922, 0.022018433, 0.033355713, 0.0021018982, -0.07147217, 0.010971069, 0.022125244, -0.017456055, -0.06549072, 0.033081055, 0.0013437271, -0.02458191, -0.018356323, 0.06414795, 0.03173828, 0.022109985, -0.0021629333, 0.009635925, -0.0064086914, -0.016540527, -0.029830933, 0.033599854, -0.0149002075, -0.03579712, 0.0074386597, -0.028564453, -0.002035141, -0.021987915, -0.019607544, -0.028549194, 0.022140503, 0.022155762, 0.056640625, -0.021881104, -0.03262329, -0.07122803, 0.041229248, 0.02658081, -0.019332886, 0.079589844, 0.04562378, -0.04647827, -0.029067993, -0.013259888, 0.023269653, 0.007320404, 0.009567261, -0.009773254, 0.0034503937, -0.0104522705, -0.06713867, -0.0074310303, 6.709099E-4, 0.060943604, -0.009529114, -0.009780884, -0.04449463, -0.037841797, -0.0010290146, -0.06713867, 0.03677368, 0.04244995, -0.016906738, -0.0056266785, -0.040649414, 0.21972656, 0.0647583, 0.019897461, -3.7240982E-4, 0.09436035, 0.07550049, 0.0109939575, 0.013023376, 4.5466423E-4, -0.04675293, -0.0050621033, 0.009567261, 0.0066833496, 0.055267334, 0.0028247833, 0.05142212, -0.062316895, 0.01953125, -0.00712204, -0.060943604, -0.05215454, 0.05529785, 9.622574E-4, 0.044708252, 0.02835083, -0.011764526, 0.011962891, -0.023101807, 0.04336548, -0.05319214, 0.023223877, -0.03253174, -0.017959595, -0.015716553, -0.02671814, -0.010398865, 0.026657104, -0.005756378, 0.0013360977, 0.04083252, 0.0071144104, -0.023513794, 0.011230469, -0.017501831, -0.03265381, 0.04083252, -0.024230957, 0.010009766, 7.019043E-4, -0.041168213, 0.018371582, -0.014533997, 0.009887695, -0.05178833, -0.04537964, 0.029922485, -0.007663727, -0.05142212, -0.007007599, 0.03338623, -5.9604645E-4, 0.01864624, -0.020889282, 0.02281189, -0.015533447, 0.029800415, -0.038635254, -0.053100586, -0.03640747, -0.033233643, -0.00274086, 0.004146576, -0.029281616, -0.043395996, -0.0047683716, 0.046203613, -0.016784668, 0.013038635, -0.01789856, -0.02281189, -0.021072388, -0.0019197464, 0.027145386, -0.05038452, 0.019454956, -0.0061569214, -0.024749756, 0.019500732, 0.0011720657, -0.020965576, 0.027542114, 0.035827637, -0.008544922, 0.021377563, 0.04034424)</td></tr></tbody></table></div></div></div>
</div>
</section>
</section>
<section id="applying-ai-sql-functions-to-multiple-rows">
<h2>Applying AI SQL Functions to multiple rows<a class="headerlink" href="#applying-ai-sql-functions-to-multiple-rows" title="Link to this heading">#</a></h2>
<p>In the SQL context, we are probably not just generating one-off LLM completions. Instead, we tend to use these functions to operate on some data. Here’s an example. Let’s use <code class="docutils literal notranslate"><span class="pre">ai_query</span></code> to correct some SQL queries and explain the corrections. We’ll start by generating a small synthetic dataset of SQL queries with errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;SELECT FROM users WHERE id = 101;&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;INSERT INTO products (name, price) VALSES (&#39;Laptop&#39;, 999.99);&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;UPDATE orders SET price = &#39;299.99&#39; WHERE od_id = 1;&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Define schema</span>
<span class="n">schema</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;raw_sql&quot;</span><span class="p">]</span>

<span class="c1"># Create DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>

<span class="c1"># Register the DataFrame as a SQL temporary view</span>
<span class="n">df</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;sql_errors&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we’ll use <code class="docutils literal notranslate"><span class="pre">ai_query</span></code> to fix these issues.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sql</span>
<span class="n">SELECT</span>
  <span class="nb">id</span><span class="p">,</span>
  <span class="n">raw_sql</span><span class="p">,</span>
  <span class="n">ai_query</span><span class="p">(</span>
    <span class="s2">&quot;databricks-mixtral-8x7b-instruct&quot;</span><span class="p">,</span>
    <span class="s2">&quot;You are a SQL expert. Fix the following SQL. Only return the corrected SQL; do not explain: &quot;</span> <span class="o">||</span> <span class="n">raw_sql</span>
  <span class="p">)</span> <span class="n">AS</span> <span class="n">corrected_sql</span>
<span class="n">FROM</span>
  <span class="n">sql_errors</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style scoped>
  .table-result-container {
    max-height: 300px;
    overflow: auto;
  }
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 5px;
  }
  th {
    text-align: left;
  }
</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>id</th><th>raw_sql</th><th>corrected_sql</th></tr></thead><tbody><tr><td>1</td><td>SELECT FROM users WHERE id = 101;</td><td> SELECT * FROM users WHERE id = 101;</td></tr><tr><td>2</td><td>INSERT INTO products (name, price) VALSES ('Laptop', 999.99);</td><td>INSERT INTO products (name, price) VALUES ('Laptop', 999.99);</td></tr><tr><td>3</td><td>UPDATE orders SET price = '299.99' WHERE od_id = 1;</td><td>UPDATE orders SET price = 299.99 WHERE od\_id = 1;</td></tr></tbody></table></div></div></div>
</div>
<p>We can expand on this and request explanations for the fixes in a new column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">sql</span>
<span class="n">WITH</span> <span class="n">CorrectedSQL</span> <span class="n">AS</span> <span class="p">(</span>
  <span class="n">SELECT</span>
    <span class="nb">id</span><span class="p">,</span>
    <span class="n">raw_sql</span><span class="p">,</span>
    <span class="n">ai_query</span><span class="p">(</span>
      <span class="s2">&quot;databricks-mixtral-8x7b-instruct&quot;</span><span class="p">,</span>
      <span class="s2">&quot;You are a SQL expert. Fix the following SQL. Only return the corrected SQL; do not explain: &quot;</span> <span class="o">||</span> <span class="n">raw_sql</span>
    <span class="p">)</span> <span class="n">AS</span> <span class="n">corrected_sql</span>
  <span class="n">FROM</span>
    <span class="n">sql_errors</span>
<span class="p">)</span>

<span class="n">SELECT</span>
  <span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
  <span class="n">c</span><span class="o">.</span><span class="n">raw_sql</span><span class="p">,</span>
  <span class="n">c</span><span class="o">.</span><span class="n">corrected_sql</span><span class="p">,</span>
  <span class="n">ai_query</span><span class="p">(</span>
    <span class="s2">&quot;databricks-mixtral-8x7b-instruct&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Given the original SQL: &#39;&quot;</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="n">raw_sql</span> <span class="o">||</span> <span class="s2">&quot;&#39; and the corrected SQL: &#39;&quot;</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="n">corrected_sql</span> <span class="o">||</span> <span class="s2">&quot;&#39;, summarize the changes and explain why they were necessary.&quot;</span>
  <span class="p">)</span> <span class="n">AS</span> <span class="n">explanation_of_fixes</span>
<span class="n">FROM</span>
  <span class="n">CorrectedSQL</span> <span class="n">c</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style scoped>
  .table-result-container {
    max-height: 300px;
    overflow: auto;
  }
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 5px;
  }
  th {
    text-align: left;
  }
</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>id</th><th>raw_sql</th><th>corrected_sql</th><th>explanation_of_fixes</th></tr></thead><tbody><tr><td>1</td><td>SELECT FROM users WHERE id = 101;</td><td> SELECT * FROM users WHERE id = 101;</td><td>1. Asterisk (*) was added in the 'SELECT' clause.
2. The space before 'FROM' was removed.

The correction was necessary to correctly specify the columns to be returned in the query result. In the original SQL, 'SELECT FROM' is incorrect syntax because it lacks the specific column(s) to be selected. Adding an asterisk (*) in the 'SELECT' clause selects all columns from the 'users' table where the 'id' is 101. The removal of the space before 'FROM' is for standard SQL syntax compliance.</td></tr><tr><td>2</td><td>INSERT INTO products (name, price) VALSES ('Laptop', 999.99);</td><td>INSERT INTO products (name, price) VALUES ('Laptop', 999.99);</td><td> Changes: The original SQL statement used "VALSES" instead of "VALUES".

 Explanation: The "VALUES" keyword is used in SQL to specify the values to be inserted into the table. The keyword "VALSES" is not a recognized SQL keyword, hence the error. The corrected SQL statement uses the correct "VALUES" keyword, making it a valid SQL statement to insert a new record into the "products" table with a name of "Laptop" and a price of 999.99.</td></tr><tr><td>3</td><td>UPDATE orders SET price = '299.99' WHERE od_id = 1;</td><td>UPDATE orders SET price = 299.99 WHERE od\_id = 1;</td><td>
The changes made to the original SQL query are minimal but significant. The single quotes around the value 299.99 in the original query have been removed in the corrected query. This change was necessary because the price field is likely a numeric type (like DECIMAL or FLOAT), and numeric values should not be enclosed in single quotes. Single quotes are used to denote string literals in SQL, not numeric values. Including single quotes around a numeric value can lead to unexpected results or errors, such as a data type conversion error. Therefore, it's essential to format numeric values correctly in SQL queries to ensure data integrity and consistency.</td></tr></tbody></table></div></div></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>You now know how to query Foundation Models from Databricks SQL and can start integrating calls to foundation models into your Databricks SQL work.</p>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/dbsql-sme-engineering/ai-query-on-dbsql-enhancing-your-data-analysis-with-genai-19537d054c5c">ai_query on DBSQL — Enhancing your data analysis with GenAI</a></p></li>
<li><p><a class="reference external" href="https://docs.databricks.com/en/large-language-models/ai-functions.html">Documentation - AI Functions on Databricks</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./nbs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Databricks Mosaic AI <br> Generative AI Cookbook</p>
      </div>
    </a>
    <a class="right-next"
       href="fast_classification_provisioned.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fast Classification with Provisioned Throughput</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-syntax">Basic Syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-completions">Generate Completions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-embeddings">Generate Embeddings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-ai-sql-functions-to-multiple-rows">Applying AI SQL Functions to multiple rows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Databricks GenAI Community
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>